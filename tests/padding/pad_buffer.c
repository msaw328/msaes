#include <stdint.h>
#include <string.h>

#include "msaes/padding.h"

int main() {
    // 1 byte of padding
    uint8_t data1[15] = {
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12
    };

    uint8_t expected_padded_data1[16] = {
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x80
    };

    uint8_t padded_data1[16] = { 0 };

    aes_pad_buffer(data1, padded_data1, 15);

    if(memcmp(padded_data1, expected_padded_data1, 16) != 0) return 1;

    // Full block of padding
    uint8_t data2[16] = {
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12
    };

    uint8_t expected_padded_data2[32] = {
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
        0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    uint8_t padded_data2[32] = { 0 };

    aes_pad_buffer(data2, padded_data2, 16);

    if(memcmp(padded_data2, expected_padded_data2, 32) != 0) return 2;

    // Random buffer
    uint8_t data3[13] = {
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
        0x12, 0x12, 0x12, 0x12, 0x12
    };

    uint8_t expected_padded_data3[16] = {
        0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12,
        0x12, 0x12, 0x12, 0x12, 0x12, 0x80, 0x00, 0x00
    };

    uint8_t padded_data3[16] = { 0 };

    aes_pad_buffer(data3, padded_data3, 13);

    if(memcmp(padded_data3, expected_padded_data3, 16) != 0) return 3;

    return 0;
}
